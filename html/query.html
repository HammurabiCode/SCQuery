<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Query</title>
    <script type="text/javascript" src="js-xlsx-dist/jszip.js"></script>
    <script type="text/javascript" src="js-xlsx-dist/xlsx.js"></script>
    <script type="text/javascript" src="js-xlsx-dist/ods.js"></script>
    <script language="javascript" type="text/javascript">
        window.onload = function ()
        {
            var oBtn = document.getElementById("btnId");
            oBtn.onclick = load_xlsx;

        }
        function load_xlsx()
        {
            var objFile = document.getElementById("fileId");
            if(objFile.value == "") {
                alert("不能空")
            }
            console.log(objFile.files[0].size); // 文件字节数

            if(objFile.files.length == 0){
                alert('请选择文件');
            }else{
                var oF = objFile.files[0];
                var reader = new FileReader();//新建一个FileReader
                reader.onload = function(evt){ //读取完文件之后会回来这里
                    var fileData = evt.target.result; // 读取文件内容
                    workbook = XLSX.read(fileData, { type: 'binary' });
                    console.log(workbook.SheetNames.length);

                }
                reader.readAsBinaryString(oF);
            }
            /*
            */

        }
    </script>
    <style type="text/css">
        .small_img {
            width:100px;
            height:100px;
        }
    </style>
</head>
<body>
    <div>
        上传文件 ： <input type="file" name="file" id="fileId" />
        <button type="submit" name="btn" value="提交" id="btnId" onclick="check()" /> 提交
    </div>
    <img class="small_img" src="../2010jpg/2010-CB12-208-1.0001.jpg" alt="0" />

</body>
</html> 